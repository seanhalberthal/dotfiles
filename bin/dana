#!/bin/bash
# Dana project launcher for tmux

SESSION="dana"

# Check if session exists
tmux has-session -t $SESSION 2>/dev/null

if [ $? != 0 ]; then
    # Create new session with backend window
    tmux new-session -d -s $SESSION -n backend -c ~/src/dana/backend

    # Window 2: web
    tmux new-window -t $SESSION -n web -c ~/src/dana/web

    # Window 3: mobile
    tmux new-window -t $SESSION -n mobile -c ~/src/dana/mobile

    # Window 4: tools (split panes)
    tmux new-window -t $SESSION -n tools -c ~/src/dana/web
    tmux split-window -h -t $SESSION:tools -c ~/src/dana/mobile

    # Run dev servers in tools panes
    tmux select-pane -t $SESSION:tools.0
    tmux send-keys -t $SESSION:tools 'npx expo' C-m
    tmux select-pane -t $SESSION:tools.1
    tmux send-keys -t $SESSION:tools 'npm run dev' C-m

    # Window 5: zsh
    tmux new-window -t $SESSION -n shell -c ~

    # Go to first window
    tmux select-window -t $SESSION:1
fi

# Attach to session
tmux attach -t $SESSION
